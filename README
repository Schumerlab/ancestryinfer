#############################
##ancestryinfer quick-start
#############################

See the user manual pdf for more complete information

###usage

perl Ancestry_HMM_parallel_v6.pl hmm_configuration_file.cfg

###set parameters in configuration file:
###See user manual pdf for details on each parameter

hmm_configuration_file.cfg

###In the configuration file, give absolute paths from the directory where the jobs are submitted in the configuration file
##for example:

./example/genome1.fa

#instead of:

genome1.fa

###The coordinates from genome1 are used as the coordinates in the HMM so this should be the better assembled genome if there are substantial differences in reference quality.

###the full path is also needed in the reads list, and that list needs to be in the directory where the analysis is being run 

###WARNING:
if you provide an AIMs file and parental count file in the configuration file, these files must be in the same order and contain exactly the same sites. Coordinates given in these files must match the provided genomes. See swordtail examples for file format.

The AIMs file *must* be provided if the genomes are non-colinear. Otherwise the program will define them using the provided fasta files.

NOTE: The genome1 fasta file cannot contain _ in the chromosome names. These can be replaced with - using i.e.: perl -pi -e 's/_/-/g' genome1.fa
The genome1 fasta file cannot contain certain symbols that are incompatible with samtools/bcftools, including = and ; 

###############
###DEPENDENCIES:
###############

######INSTALL INSTRUCTIONS FOR DEPENDENCIES ARE DETAILED HERE:
installation_instructions.txt

###depends on the following programs that most clusters will already have installed:
##bwa ~(v0.7.15)
##samtools ~(v1.3.1)
##bcftools ~(1.3.1)

###depends on the following packages/libraries that will probably not already be installed
##armadillo #wget http://sourceforge.net/projects/arma/files/armadillo-7.960.0.tar.xz
##gperftools #git clone https://github.com/gperftools/gperftools.git
##ngsutils #git clone git://github.com/ngsutils/ngsutils.git
##Ancestry_HMM # git clone https://github.com/russcd/Ancestry_HMM.git
###NOTE: Ancestry_HMM will not install properly without armadillo and gperftools

##to test whether the pipeline will have required dependencies before running, go to the folder where you will submit the job and type:

bwa
samtools
bcftools
bamutils
ancestry_hmm

#if all of these print the usage, then you are good to go!


################################################
###if your run does not complete successfully
###############################################

#if your run fails in the middle you can cleanup files generated by running:

perl cleanup_script.pl read_list_name

#this script will also remove intermediate files if you set that option to save all files
